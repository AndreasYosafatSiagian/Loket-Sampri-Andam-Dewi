<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pemesanan Tiket - Pilih Kursi | Travel Nusantara</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #f3f9ff;
      font-family: 'Poppins', sans-serif;
      margin: 0;
      color: #023e24;
    }

    header {
      background-color: #00853e;
      color: white;
      padding: 15px 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    header img {
      width: 60px;
      border-radius: 10px;
    }

    nav {
      background-color: #0059b3;
      text-align: center;
      padding: 12px;
    }

    nav a {
      color: white;
      text-decoration: none;
      font-weight: 600;
      margin: 0 20px;
    }

    nav a:hover {
      color: #ffd700;
    }

    main {
      background: white;
      border-radius: 15px;
      max-width: 900px;
      margin: 40px auto;
      padding: 30px 40px;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }

    h2 {
      text-align: center;
      color: #00853e;
    }

    form {
      max-width: 700px;
      margin: auto;
    }

    label {
      font-weight: 600;
      display: block;
      margin-top: 15px;
      color: #03491e;
    }

    select, input {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #cce0ff;
      margin-top: 5px;
      font-size: 1rem;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #00a83f;
      box-shadow: 0 0 6px rgba(0,168,63,0.3);
    }

    /* AREA KURSI */
    .bus-layout {
      display: grid;
      gap: 10px;
      justify-content: center;
      margin-top: 25px;
    }

    .seat {
      width: 45px;
      height: 45px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      cursor: pointer;
      transition: 0.3s;
    }

    .seat.available { background-color: #43d17e; color: white; }
    .seat.booked { background-color: #d14444; color: white; cursor: not-allowed; }
    .seat.selected { background-color: #3b82f6; color: white; }

    .seat:hover.available { background-color: #00a83f; }

    .legend {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 15px 0;
    }

    .legend div { display: flex; align-items: center; gap: 8px; }
    .legend .box { width: 20px; height: 20px; border-radius: 4px; }

    button {
      width: 100%;
      padding: 12px;
      background-color: #00a83f;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      margin-top: 20px;
    }

    button:hover { background-color: #037a2b; }

    footer {
      background-color: #00853e;
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: 40px;
    }
  </style>
</head>
<body>

  <header>
    <div style="display:flex; align-items:center; gap:15px;">
      <img src="q3.jpeg" alt="Logo Travel">
      <h1>Loket Perwakilan Andam Dewi PT. Sampri</h1>
    </div>
  </header>

  <nav>
    <a href="index.html">Beranda</a>
    <a href="jadwal.html">Jadwal</a>
    <a href="pemesanan.html">Pesan Tiket</a>
    <a href="kontak.html">Kontak</a>
  </nav>

  <main>
    <h2>Pesan Tiket & Pilih Kursi</h2>

    <form id="formTiket">
      <label for="rute">Rute Perjalanan</label>
      <select id="rute" required>
        <option value="">-- Pilih Rute --</option>
        <option>Andam Dewi ‚Üí Medan</option>
        <option>Andam Dewi ‚Üí Dolok Sanggul</option>
        <option>Andam Dewi ‚Üí Sidikalang</option>
        <option>Andam Dewi ‚Üí Merek</option>
        <option>Andam Dewi ‚Üí Berastagi</option>
      </select>

      <label for="mobil">Jenis Mobil</label>
      <select id="mobil" required>
        <option value="">-- Pilih Jenis Mobil --</option>
        <option value="hiace">Toyota Hiace (11 kursi)</option>
        <option value="royal">Royal Class (8 kursi)</option>
        <option value="executive">Executive (22 kursi)</option>
      </select>

      <label for="jam">Jam Keberangkatan</label>
      <select id="jam" required>
        <option value="">-- Pilih Jam --</option>
        <option value="09:00">09:00 (Pagi)</option>
        <option value="17:30">17:30 (Sore)</option>
        <option value="19:30">19:30 (Malam)</option>
      </select>

      <label for="nama">Nama Penumpang</label>
      <input type="text" id="nama" placeholder="Masukkan nama lengkap" required>

      <h3 style="text-align:center; color:#00853e;">Pilih Kursi</h3>

      <div class="legend">
        <div><div class="box" style="background:#43d17e"></div> Kosong</div>
        <div><div class="box" style="background:#d14444"></div> Terisi</div>
        <div><div class="box" style="background:#3b82f6"></div> Dipilih</div>
      </div>

      <div class="bus-layout" id="seatLayout">
        <p style="text-align:center; color:#777;">Pilih jenis mobil terlebih dahulu.</p>
      </div>

      <input type="hidden" id="kursiTerpilih">

      <button type="submit">Pesan Sekarang</button>
    </form>
  </main>

  <footer>
    ¬© 2025 Travel Nusantara | Sistem Pemesanan Tiket Modern
  </footer>

  <script>
    const seatLayout = document.getElementById('seatLayout');
    const kursiTerpilih = document.getElementById('kursiTerpilih');
    const mobilSelect = document.getElementById('mobil');
    const jamSelect = document.getElementById('jam');

    // Jadwal valid per jenis mobil
    const jadwalValid = {
      hiace: ["19:30"],
      royal: ["17:30"],
      executive: ["09:00"]
    };

    // Kursi yang sudah dipesan
    const bookedSeats = {
      hiace: ["A1", "B2", "C3"],
      royal: ["A2", "B3"],
      executive: ["A1", "A5", "C2", "D4", "E3"]
    };

    mobilSelect.addEventListener('change', function() {
      // Update layout kursi
      buatLayoutKursi(this.value);
      // Update jam keberangkatan
      updateJam(this.value);
    });

    function updateJam(jenis) {
      const options = jamSelect.options;
      for (let i = 0; i < options.length; i++) {
        const val = options[i].value;
        if (!val) continue;
        if (jadwalValid[jenis]?.includes(val)) {
          options[i].disabled = false;
          options[i].style.color = "#000";
        } else {
          options[i].disabled = true;
          options[i].style.color = "#aaa";
        }
      }
      jamSelect.value = ""; // reset jam setelah ganti mobil
    }

    function buatLayoutKursi(jenis) {
      seatLayout.innerHTML = '';
      kursiTerpilih.value = '';

      let total = 0;
      let baris = [];
      let kolom = [];

      if (jenis === 'hiace') {
        total = 11; baris = ["A","B","C"]; kolom = [1,2,3,4];
        seatLayout.style.gridTemplateColumns = 'repeat(4, 1fr)';
      } else if (jenis === 'royal') {
        total = 8; baris = ["A","B"]; kolom = [1,2,3,4];
        seatLayout.style.gridTemplateColumns = 'repeat(4, 1fr)';
      } else if (jenis === 'executive') {
        total = 22; baris = ["A","B","C","D","E"]; kolom = [1,2,3,4,5];
        seatLayout.style.gridTemplateColumns = 'repeat(5, 1fr)';
      } else {
        seatLayout.innerHTML = "<p style='text-align:center; color:#777;'>Pilih jenis mobil terlebih dahulu.</p>";
        return;
      }

      const booked = bookedSeats[jenis];

      let count = 0;
      baris.forEach(b => {
        kolom.forEach(k => {
          if (count >= total) return;
          const seatId = b + k;
          const seat = document.createElement('div');
          seat.classList.add('seat');
          seat.textContent = seatId;

          if (booked.includes(seatId)) {
            seat.classList.add('booked');
          } else {
            seat.classList.add('available');
            seat.addEventListener('click', () => pilihKursi(seat, seatId));
          }

          seatLayout.appendChild(seat);
          count++;
        });
      });
    }

    function pilihKursi(seat, id) {
      document.querySelectorAll('.seat.selected').forEach(s => s.classList.remove('selected'));
      seat.classList.add('selected');
      kursiTerpilih.value = id;
    }

    document.getElementById('formTiket').addEventListener('submit', function(e) {
      e.preventDefault();
      if (!kursiTerpilih.value) {
        alert("Silakan pilih kursi terlebih dahulu!");
        return;
      }
      if (!jamSelect.value) {
        alert("Jam keberangkatan belum sesuai dengan jadwal mobil yang dipilih!");
        return;
      }

      alert(
        "‚úÖ Pemesanan Berhasil!\n" +
        "Nama: " + document.getElementById('nama').value +
        "\nRute: " + document.getElementById('rute').value +
        "\nMobil: " + mobilSelect.options[mobilSelect.selectedIndex].text +
        "\nJam: " + jamSelect.options[jamSelect.selectedIndex].text +
        "\nKursi: " + kursiTerpilih.value +
        "\n\nTerima kasih telah memilih Travel Nusantara üöê"
      );
      this.reset();
      seatLayout.innerHTML = "<p style='text-align:center; color:#777;'>Pilih jenis mobil terlebih dahulu.</p>";
    });
  </script>
</body>
</html>
